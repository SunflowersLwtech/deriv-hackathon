# ─── TradeIQ - Render Blueprint (One-Click Deploy) ────────
# Deploy: Connect GitHub repo → Render auto-detects this file
# Docs: https://docs.render.com/blueprint-spec
# ───────────────────────────────────────────────────────────

services:
  # ── Backend: Django + Daphne (ASGI) ──
  - type: web
    name: tradeiq-backend
    runtime: docker
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: DJANGO_SECRET_KEY
        generateValue: true
      - key: DEBUG
        value: "False"
      - key: ALLOWED_HOSTS
        value: "*"
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_JWT_SECRET
        sync: false
      - key: DEEPSEEK_API_KEY
        sync: false
      - key: OPENROUTER_API_KEY
        sync: false
      - key: DERIV_APP_ID
        sync: false
      - key: DERIV_TOKEN
        sync: false
      - key: NEWS_API_KEY
        sync: false
      - key: FINNHUB_API_KEY
        sync: false
      - key: BLUESKY_HANDLE
        sync: false
      - key: BLUESKY_APP_PASSWORD
        sync: false
      - key: REDIS_URL
        sync: false
    healthCheckPath: /api/market/insights/

  # ── Frontend: Next.js ──
  - type: web
    name: tradeiq-frontend
    runtime: docker
    dockerfilePath: ./frontend/Dockerfile
    dockerContext: ./frontend
    envVars:
      - key: NEXT_PUBLIC_API_URL
        sync: false
      - key: NEXT_PUBLIC_WS_URL
        sync: false
      - key: NEXT_PUBLIC_SUPABASE_URL
        sync: false
      - key: NEXT_PUBLIC_SUPABASE_ANON_KEY
        sync: false
      - key: NEXT_PUBLIC_AUTH_CALLBACK_URL
        sync: false
      - key: NEXT_OUTPUT
        value: standalone
